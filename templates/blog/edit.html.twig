{% extends 'base.html.twig' %}

{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–≥{% endblock %}

{% block body %}
    <div class="container mt-4">
        <div class="card">
            <div class="card-header">
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–≥</h3>
            </div>
            <div class="card-body">
                {% if existingAttachments is not empty %}
                    <div class="mb-4">
                        <h5>–¢–µ–∫—É—â–∏–µ —Ñ–∞–π–ª—ã ({{ existingAttachments|length }})</h5>
                        <div class="list-group">
                            {% for attachment in existingAttachments %}
                                <div class="list-group-item d-flex justify-content-between align-items-center">
                                    <div>
                                        <span style="font-size: 20px;">{{ attachment.icon }}</span>
                                        <a href="/uploads/attachments/{{ attachment.filename }}" target="_blank" class="ms-2">
                                            {{ attachment.originalFilename }}
                                        </a>
                                        <small class="text-muted ms-2">({{ attachment.fileSizeFormatted }})</small>
                                    </div>
                                    <form method="post" action="{{ path('attachment_delete', {'id': attachment.id}) }}" style="display: inline;">
                                        <input type="hidden" name="_method" value="DELETE">
                                        <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª?');">
                                            –£–¥–∞–ª–∏—Ç—å
                                        </button>
                                    </form>
                                </div>
                            {% endfor %}
                        </div>
                        <hr class="my-4">
                    </div>
                {% endif %}

                {{ form_start(form, {'attr': {'enctype': 'multipart/form-data'}}) }}
                {{ form_row(form.title) }}
                {{ form_row(form.category) }}
                {{ form_row(form.status) }}
                {{ form_row(form.participants) }}
                {{ form_row(form.content) }}

                <div class="mb-3">
                    <label class="form-label">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>

                    <div class="file-upload-area" id="dropZone">
                        <div class="file-upload-icon">üìé</div>
                        <p class="mb-2"><strong>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</strong></p>
                        <p class="text-muted mb-2">–∏–ª–∏</p>
                        <button type="button" class="btn btn-secondary btn-sm" id="chooseFilesBtn">
                            –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã
                        </button>
                        <div id="fileList" class="file-list"></div>
                    </div>

                    <div style="display: none;">
                        {{ form_widget(form.attachments) }}
                    </div>

                    <div class="form-text">
                        –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, GIF, WEBP) - –º–∞–∫—Å. 10 –ú–ë<br>
                        –ê—É–¥–∏–æ (MP3, WAV, OGG) - –º–∞–∫—Å. 20 –ú–ë<br>
                        –î–æ–∫—É–º–µ–Ω—Ç—ã (PDF, DOC, DOCX, TXT, MD) - –º–∞–∫—Å. 10 –ú–ë<br>
                        –î–æ 5 —Ñ–∞–π–ª–æ–≤ –Ω–∞ –±–ª–æ–≥
                    </div>
                    {{ form_errors(form.attachments) }}
                </div>

                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                <a href="{{ path('blog_show', {'id': blog.id}) }}" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
                {{ form_end(form) }}
            </div>
        </div>
    </div>
{% endblock %}